/* =============================== */
/*          VARIABLES CSS          */
/* =============================== */
:root {
    /* Colores primarios y de acento (para animaciones y efectos del texto "dulCE!") */
    --primary: #6ab1ee;
    --primary-dark: #4a90e2;
    --accent: #FFD700;

    /* Colores MS Paint / Windows 95 UI */
    --ms-paint-bg-light: #C0C0C0; /* Fondo principal gris claro */
    --ms-paint-bg-medium: #A0A0A0; /* Gris medio para elementos */
    --ms-paint-bg-dark: #808080; /* Gris oscuro para sombras */
    --ms-paint-border-light: #FFFFFF; /* Blanco para realces 3D */
    --ms-paint-border-dark: #808080; /* Gris oscuro para sombras 3D */
    --ms-paint-border-shadow: #000000; /* Negro para bordes duros y sombras de ventana */
    --ms-paint-titlebar-blue: #000080; /* Azul de la barra de título */
    --ms-paint-menubar-yellow: #F0F000; /* Amarillo de la barra de menú (aproximado) */
    --ms-paint-statusbar-green: #00A000; /* Verde de la barra de estado */
    --ms-paint-text-primary: #000000; /* Texto negro */
    --ms-paint-text-secondary: #404040; /* Texto gris oscuro */

    /* Colores específicos para el texto "Dulce!" y su fondo (oscuro) - Basado en la imagen NEÓN NARANJA/ROJO */
    --dulce-text-color: #FF8C00; /* Naranja */
    --dulce-outline-color: #8B0000; /* Rojo Oscuro */
    --dulce-shadow-color: #FFD700; /* Dorado para la sombra pixelada */
    --dulce-background-dark: #1a1a2e; /* Fondo oscuro para el área de demostración */

    /* Mapeo de variables originales a los nuevos estilos de UI (solo donde aplica a la UI) */
    --bg-darker: var(--dulce-background-dark);
    --bg-dark: var(--dulce-background-dark);
    --bg-content: var(--ms-paint-bg-light);
    --bg-card: var(--ms-paint-bg-light);

    --text-light: var(--ms-paint-text-primary);
    --text-muted: var(--ms-paint-text-secondary);
    --text-highlight: var(--ms-paint-text-primary);

    --card-border: var(--ms-paint-border-shadow);
    --divider-line: var(--ms-paint-border-dark);

    /* Efectos (manteniendo los valores originales para animaciones de texto/partículas) */
    --blur-strength: 10px;
    --shadow-medium: 0 10px 20px rgba(0, 0, 0, 0.2);
    --shadow-large: 0 15px 35px rgba(0, 0, 0, 0.5);

    /* Tipografía */
    --ui-font-family: 'Pixelify Sans', 'Consolas', monospace; /* Para la UI retro */
    --text-font-family: 'Pixelify Sans', 'Consolas', monospace; /* Para el texto "Dulce!" también pixelado */
    --font-size-base: 11px; /* Tamaño de fuente base más pequeño para la UI */
    --font-weight-bold: 700;
}

/* =============================== */
/*          RESET BÁSICO           */
/* =============================== */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: var(--ui-font-family); /* Por defecto, fuente pixel para la UI */
    -webkit-font-smoothing: none; /* Asegura el renderizado pixelado para la UI */
    font-smoothing: none;
}

/* =============================== */
/*            BODY                 */
/* =============================== */
body {
    background: var(--ms-paint-bg-light); /* Fondo gris claro de Windows 95 */
    color: var(--ms-paint-text-primary);
    height: 100vh; /* Ocupa toda la altura de la ventana */
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden; /* Evita el scroll en el body */
    padding: 3px; /* Padding muy reducido */
    font-size: var(--font-size-base);
}

/* =============================== */
/*          CONTENEDOR PRINCIPAL (LA VENTANA DE PAINT) */
/* =============================== */
.container {
    display: flex;
    flex-wrap: nowrap; /* No wrapping for main content */
    max-width: 900px; /* Ancho ajustado */
    width: 100%;
    height: 100%; /* Ocupa toda la altura del body */
    background: var(--ms-paint-bg-light);
    border-radius: 0;
    overflow: hidden;
    box-shadow: 2px 2px 0px var(--ms-paint-border-shadow); /* Sombra más pequeña */
    backdrop-filter: none;
    border: 1px solid var(--ms-paint-border-shadow); /* Borde más fino */
    transform: none;
    position: relative;
    flex-direction: column;
}

/* Barra de título de MS Paint */
.container::before {
    content: "Paint - (untitled)"; /* Título */
    display: block;
    background-color: var(--ms-paint-titlebar-blue);
    color: var(--ms-paint-border-light);
    padding: 1px 4px; /* Padding muy reducido */
    font-size: 0.8em;
    font-weight: bold;
    text-align: left;
    border-bottom: 1px solid var(--ms-paint-border-shadow);
    box-shadow: 1px 1px 0px rgba(0,0,0,0.5); /* Sombra sutil */
    line-height: 1.2; /* Ajuste de altura de línea */
}

/* Barra de menú de MS Paint */
.container::after {
    content: "File Edit Font FontSize Style Palette Options"; /* Menú */
    display: block;
    background-color: var(--ms-paint-menubar-yellow);
    color: var(--ms-paint-text-primary);
    padding: 1px 4px; /* Padding muy reducido */
    font-size: 0.7em; /* Fuente más pequeña */
    text-align: left;
    border-bottom: 1px solid var(--ms-paint-border-dark);
    line-height: 1.2;
}

/* REEMPLAZO: EL NUEVO CONTENEDOR PARA LOS PANELES */
.app-content-area {
    display: flex;
    flex-wrap: nowrap;
    flex: 1; /* Ocupa el espacio restante en el contenedor */
    min-height: 0; /* Clave para que flexbox funcione correctamente en altura */
}


/* =============================== */
/*        CONTENEDOR DE CONTROLES (Panel izquierdo)  */
/* =============================== */
.controls-container {
    flex: 0 0 200px; /* Ancho fijo más compacto para los controles */
    padding: 8px; /* Padding reducido */
    background: var(--ms-paint-bg-light);
    border-right: 1px solid var(--ms-paint-border-shadow); /* Borde más fino */
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--ms-paint-bg-dark) var(--ms-paint-bg-medium);
}

/* Estilos para el nuevo Header de la App - AHORA CON ESTILO MS PAINT */
.app-header {
    text-align: center;
    margin-bottom: 1rem; /* Margen ajustado */
    padding: 10px 5px;
    background: var(--ms-paint-bg-light);
    /* Borde 3D "hundido" clásico */
    border: 1px solid;
    border-color: var(--ms-paint-border-dark) var(--ms-paint-border-light) var(--ms-paint-border-light) var(--ms-paint-border-dark);
    position: relative;
}

.app-header h1 {
    margin: 0 0 5px 0;
    font-size: 1.5rem; /* Tamaño ajustado para el panel */
    font-family: var(--text-font-family); /* Usa la fuente de texto principal */
    -webkit-font-smoothing: none;
    font-smoothing: none;
    display: flex; /* Necesario para los spans de caracteres */
    justify-content: center;
    min-height: 30px; /* Evita saltos de layout mientras se carga */
}

.app-header p {
    margin: 0;
    color: var(--ms-paint-text-secondary);
    font-size: 0.75em;
}

.demo-container {
    flex: 1; /* Ocupa el resto del espacio */
    min-width: 300px; /* Ancho mínimo para el demo */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 5px; /* Padding muy reducido */
    background: var(--dulce-background-dark); /* Fondo oscuro para el texto "dulCE!" */
    position: relative;
    /* Borders handled by the panels on either side */
    padding-bottom: 25px; /* Espacio para la barra de estado */
}

/* Barra de estado MS Paint */
.ms-paint-status-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 20px; /* Altura fija reducida */
    background-color: var(--ms-paint-statusbar-green);
    border-top: 1px solid var(--ms-paint-border-shadow); /* Borde superior más fino */
    display: flex;
    align-items: center;
    padding: 0 5px; /* Padding reducido */
    color: var(--ms-paint-text-primary);
    font-size: 0.7em; /* Fuente más pequeña */
    gap: 10px; /* Espacio reducido */
}
.ms-paint-status-item {
    padding: 1px 3px; /* Padding reducido */
    border: none;
    border-top: 1px solid var(--ms-paint-border-dark);
    border-left: 1px solid var(--ms-paint-border-dark);
    border-right: 1px solid var(--ms-paint-border-light);
    border-bottom: 1px solid var(--ms-paint-border-light);
    background-color: var(--ms-paint-bg-light);
}

.ms-paint-zoom-level {
    margin-left: auto; /* Empuja el zoom a la derecha */
    padding: 1px 3px;
    border: none;
    border-top: 1px solid var(--ms-paint-border-dark);
    border-left: 1px solid var(--ms-paint-border-dark);
    border-right: 1px solid var(--ms-paint-border-light);
    border-bottom: 1px solid var(--ms-paint-border-light);
    background-color: var(--ms-paint-bg-light);
}

/* =============================== */
/*         NUEVO PANEL DERECHO (Marcador)      */
/* =============================== */
.right-panel {
    flex: 0 0 200px; /* Ancho fijo para el panel derecho (aumentado para mejor UX) */
    background: var(--ms-paint-bg-light);
    border-left: 1px solid var(--ms-paint-border-shadow); /* Borde separador */
    overflow-x: hidden; /* Evita el scroll horizontal no deseado */
    display: flex;
    flex-direction: column;
}

.right-panel .panel-header {
    background-color: var(--ms-paint-bg-medium); /* Fondo de la barra de título del panel */
    color: var(--ms-paint-text-primary);
    padding: 3px 6px;
    font-weight: bold;
    font-size: 0.8em;
    border-bottom: 1px solid var(--ms-paint-border-dark);
    border-top: 1px solid var(--ms-paint-border-light);
    margin-bottom: 5px;
}

.right-panel .panel-content {
    padding: 5px;
    flex-grow: 1; /* Permite que el contenido se expanda */
}

/* =============================== */
/*      SELECTOR DE FONDO (PALETA DE COLORES) - AHORA EN EL PANEL DERECHO */
/* =============================== */
/* Eliminar posicionamiento absoluto anterior */
.background-selector {
    position: static;
    top: unset;
    right: unset;
    display: grid;
    /* Las columnas se ajustan para el panel derecho */
    grid-template-columns: repeat(4, 1fr); /* 4 columnas en el panel derecho */
    gap: 0; /* Espacio muy reducido */
    z-index: 10;
    border: 1px solid;
    border-color: var(--ms-paint-border-light) var(--ms-paint-border-dark) var(--ms-paint-border-dark) var(--ms-paint-border-light);
    background-color: var(--ms-paint-bg-light);
    padding: 1px;
    width: fit-content; /* Ajustar el ancho a su contenido */
    margin: 0 auto; /* Centrar la paleta */
    margin-bottom: 8px; /* Aumentar margen inferior para separar de los botones de acción */
}

.bg-btn {
    width: 18px; /* Botones más pequeños */
    height: 18px;
    border-radius: 0;
    border: 1px solid var(--ms-paint-border-shadow);
    cursor: pointer;
    transition: none;
    position: relative; /* Necesario para que el tooltip se posicione correctamente */
    background-clip: padding-box;
}

.bg-btn:hover {
    transform: none;
    box-shadow: none;
    border: 1px dashed var(--ms-paint-border-dark); /* Borde de selección discontinua */
}

.bg-btn.active {
    transform: none;
    box-shadow: none;
    border: 2px solid var(--ms-paint-titlebar-blue); /* Borde azul para activo */
}

/* =============================== */
/*          ELEMENTOS DE FORMULARIO */
/* =============================== */
fieldset {
    border: none;
    border-top: 1px solid var(--ms-paint-border-light); /* Bordes más finos */
    border-left: 1px solid var(--ms-paint-border-light);
    border-right: 1px solid var(--ms-paint-border-dark);
    border-bottom: 1px solid var(--ms-paint-border-dark);
    border-radius: 0;
    padding: 6px; /* Padding reducido */
    margin-bottom: 10px; /* Margen reducido */
    background: var(--ms-paint-bg-light);
    transition: none;
}
/* Estilo específico para el fieldset de presets en el panel derecho */
.right-panel .presets-fieldset {
    margin-bottom: 8px; /* Menor margen si hay otros elementos debajo */
    padding: 4px; /* Padding reducido */
}

fieldset:hover {
    transform: none;
    box-shadow: none;
}

legend {
    font-weight: var(--font-weight-bold);
    padding: 0 2px; /* Padding reducido */
    color: var(--ms-paint-text-primary);
    font-size: 0.8em; /* Fuente más pequeña */
    display: flex;
    align-items: center;
    gap: 3px; /* Espacio reducido */
    margin-bottom: 4px; /* Margen reducido */
    background-color: var(--ms-paint-bg-light);
    position: relative;
    top: -7px; /* Ajuste para que la leyenda se superponga al borde */
    left: -4px; /* Ajuste para que la leyenda se superponga al borde */
    border: 1px solid;
    border-color: var(--ms-paint-border-dark) var(--ms-paint-border-light) var(--ms-paint-border-light) var(--ms-paint-border-dark);
    padding: 1px 4px; /* Padding muy reducido */
    cursor: pointer; /* Indicar que es interactivo */
}

legend:hover {
    background-color: var(--ms-paint-bg-medium);
}

/* Estilo visual para la leyenda activa (simulando "presionada") */
fieldset.active > legend {
    border-color: var(--ms-paint-border-dark) var(--ms-paint-border-light) var(--ms-paint-border-light) var(--ms-paint-border-dark); /* Borde hundido */
    background-color: var(--ms-paint-bg-medium);
}

/* Ocultar iconos de legend para la UI de MS Paint */
legend i {
    display: none;
}

/* Ocultar el contenido del acordeón por defecto */
.accordion-content {
    display: none;
    padding-top: 5px; /* Espacio entre la leyenda y el contenido */
}

/* Mostrar el contenido del acordeón cuando el fieldset padre está activo */
.accordion-item.active .accordion-content {
    display: block;
}

.control-group {
    margin-bottom: 6px; /* Margen reducido */
    position: relative;
}

/* Línea divisoria entre grupos de controles */
.control-group:not(:last-child)::after {
    content: '';
    position: absolute;
    bottom: -3px; /* Posición ajustada */
    left: 0;
    width: 100%;
    height: 1px;
    background: var(--ms-paint-border-dark);
}

label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2px; /* Margen reducido */
    font-size: 0.75em; /* Fuente más pequeña */
    color: var(--ms-paint-text-primary);
}

/* Iconos de Font Awesome dentro de los labels, visibles */
label span:first-child {
    display: flex;
    align-items: center;
    gap: 3px;
    color: var(--ms-paint-text-primary);
    font-weight: var(--font-weight-bold);
}
label span:first-child i {
    display: inline-block; /* Asegura que los iconos sean visibles aquí */
    font-size: 1em; /* Iconos un poco más grandes para mayor claridad */
}


/* Estilos generales para inputs */
input[type="range"],
input[type="color"],
input[type="text"] {
    border-radius: 0;
    border: none;
    border-top: 1px solid var(--ms-paint-border-dark); /* Bordes más finos */
    border-left: 1px solid var(--ms-paint-border-dark);
    border-right: 1px solid var(--ms-paint-border-light);
    border-bottom: 1px solid var(--ms-paint-border-light);
    background: white;
    color: var(--ms-paint-text-primary);
    transition: none;
    outline: none;
}

input[type="range"] {
    width: 100%;
    height: 3px; /* Pista más delgada */
    cursor: pointer;
    -webkit-appearance: none;
    background: var(--ms-paint-bg-light);
    border: 1px solid var(--ms-paint-border-dark);
}

input[type="range"]:hover {
    background: var(--ms-paint-bg-light);
}

/* Estilos para el pulgar (thumb) del slider */
input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 8px; /* Pulgar más pequeño */
    height: 8px;
    border-radius: 0;
    background: var(--ms-paint-bg-light);
    cursor: pointer;
    border: 1px solid var(--ms-paint-border-shadow);
    box-shadow: none;
    margin-top: -3px; /* Ajuste */
    transition: none;
}

input[type="range"]::-webkit-slider-thumb:hover {
    background: var(--ms-paint-bg-medium);
    transform: none;
}

input[type="color"] {
    height: 16px; /* Altura reducida */
    padding: 0;
    cursor: pointer;
}

input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 0;
}
input[type="color"]::-webkit-color-swatch {
    border: none;
    border-radius: 0;
}

input[type="color"]:hover {
    transform: none;
}

input[type="text"] {
    width: 100%;
    padding: 2px; /* Padding reducido */
    font-size: 0.8em; /* Fuente más pequeña */
}

input[type="text"]:focus {
    border: 1px dashed var(--ms-paint-titlebar-blue); /* Borde de foco más fino */
    box-shadow: none;
}

.value-display {
    color: var(--ms-paint-text-primary);
    font-weight: var(--font-weight-bold);
    min-width: 25px; /* Ancho mínimo reducido */
    text-align: right;
    font-size: 0.7em; /* Fuente más pequeña */
}

/* =============================== */
/*          BOTONES DE ACCIÓN (Panel izquierdo)      */
/* =============================== */
/* REUBICADO: Ahora en el panel derecho */
.right-panel .actions {
    margin-top: 8px; /* Margen reducido */
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 4px; /* Espacio reducido */
    border-bottom: 1px solid var(--ms-paint-border-dark);
    padding-bottom: 8px;
}

/* Estilos para todos los botones - Clásico botón 3D de Windows */
#copy-css-button, #reset-button, .preset-btn, #undo-button, #redo-button {
    background: var(--ms-paint-bg-light);
    color: var(--ms-paint-text-primary);
    border: none;
    border-top: 1px solid var(--ms-paint-border-light); /* Bordes más finos */
    border-left: 1px solid var(--ms-paint-border-light);
    border-right: 1px solid var(--ms-paint-border-dark);
    border-bottom: 1px solid var(--ms-paint-border-dark);
    padding: 3px 6px; /* Padding muy reducido */
    border-radius: 0;
    cursor: pointer;
    font-weight: var(--font-weight-bold);
    transition: none;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 3px;
    font-size: 0.8em; /* Fuente más pequeña */
}

/* Iconos en los botones, visibles */
#copy-css-button i, #reset-button i, .preset-btn i, #undo-button i, #redo-button i {
    display: inline-block;
    font-size: 0.9em;
}

/* Estado hover/activo de los botones (efecto "presionado") */
#copy-css-button:hover, #reset-button:hover, .preset-btn:hover, #undo-button:hover, #redo-button:hover {
    background: var(--ms-paint-bg-medium);
    border-top: 1px solid var(--ms-paint-border-dark);
    border-left: 1px solid var(--ms-paint-border-dark);
    border-right: 1px solid var(--ms-paint-border-light);
    border-bottom: 1px solid var(--ms-paint-border-light);
    transform: translateY(1px);
    box-shadow: none;
}

/* Estilo para botones deshabilitados */
#undo-button:disabled, #redo-button:disabled {
    color: var(--ms-paint-text-secondary);
    background: var(--ms-paint-bg-light);
    border-color: var(--ms-paint-border-light) var(--ms-paint-border-dark) var(--ms-paint-border-dark) var(--ms-paint-border-light);
    cursor: not-allowed;
    transform: none;
}
#reset-button {
    background: #DC3545;
    color: white;
    border-color: #F8B4BB #8F1B2A #8F1B2A #F8B4BB;
}

#reset-button:hover {
    background: #C0392B;
    border-color: #8F1B2A #F8B4BB #F8B4BB #8F1B2A;
    transform: translateY(1px);
}

/* Mensaje de copia */
#copy-message {
    margin-top: 2px;
    height: 12px; /* Altura reducida */
    font-size: 0.7em;
    color: var(--ms-paint-text-primary);
    opacity: 0;
    transition: none;
}

#copy-message.visible {
    opacity: 1;
}

/* =============================== */
/*        TEXTO DE DEMO GRANDE ("Dulce!") */
/* =============================== */
.text-demo {
    width: 100%;
    text-align: center;
    padding: 8px; /* Padding reducido */
    border-radius: 0;
    background: none;
    box-shadow: none;
    margin-top: 8px; /* Margen reducido */
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
}

#vanish-shadow {
    font-size: 80px; /* Tamaño de fuente ajustado para pixelado grande */
    font-weight: 800; /* Hace que los píxeles sean más gruesos */
    display: flex;
    justify-content: center;
    /* --- ESTILOS PIXELADOS NEÓN NARANJA/ROJO PARA "Dulce!" --- */
    font-family: var(--text-font-family); /* Fuente pixelada */
    -webkit-font-smoothing: none; /* Renderizado pixelado */
    font-smoothing: none;
    color: var(--dulce-text-color); /* Color base naranja */
    /* Contorno pixelado */
    -webkit-text-stroke: 2px var(--dulce-outline-color);
    text-stroke: 2px var(--dulce-outline-color);
    letter-spacing: -0.1em; /* Ajuste para espaciado pixelado */
    perspective: 500px;
    /* Sombra de glow pixelada/dura */
    text-shadow:
        0 0 3px var(--dulce-shadow-color),
        0 0 6px var(--dulce-shadow-color),
        0 0 9px var(--dulce-shadow-color),
        2px 2px 0px rgba(0,0,0,0.5); /* Sombra dura de fondo para profundidad */
    transition: all 0.5s ease;
    padding: 0;
    border-radius: 0;
}

#vanish-shadow .char {
    display: inline-block;
    position: relative;
    transition: transform 0.3s ease, color 0.3s ease, text-shadow 0.3s ease;
}

#vanish-shadow .char:hover {
    transform: translateY(-3px) scale(1.05); /* Efecto hover más sutil */
    text-shadow:
        0 0 5px var(--dulce-shadow-color),
        0 0 10px var(--dulce-shadow-color),
        0 0 15px var(--dulce-shadow-color),
        2px 2px 0px rgba(0,0,0,0.5);
}

/* Estilo para el modo arcoíris (ajustado para pixelado neón) */
.rainbow-mode-active .char {
    color: hsl(calc(var(--char-index) * 57), 100%, 70%) !important; /* Colores más saturados para neón */
    animation: rainbow-pulse 3s infinite alternate;
    text-shadow:
        0 0 3px currentColor,
        0 0 6px currentColor,
        0 0 9px currentColor,
        2px 2px 0px rgba(0,0,0,0.5); /* Glow con el color del carácter */
    -webkit-text-stroke: 2px rgba(0,0,0,0.5); /* Contorno oscuro */
}

@keyframes rainbow-pulse {
    0% { filter: brightness(1) hue-rotate(0deg); }
    100% { filter: brightness(1.2) hue-rotate(360deg); }
}

/* =============================== */
/*           SWITCH TOGGLE         */
/* =============================== */
.switch-group {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 6px; /* Margen reducido */
}

.switch {
    position: relative;
    display: inline-block;
    width: 25px; /* Switch más pequeño y cuadrado */
    height: 14px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--ms-paint-bg-medium);
    transition: none;
    border-radius: 0;
    border: 1px solid var(--ms-paint-border-dark);
}

.slider:before {
    position: absolute;
    content: "";
    height: 10px; /* Pulgar cuadrado más pequeño */
    width: 10px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    transition: none;
    border-radius: 0;
    border: 1px solid var(--ms-paint-border-shadow);
}

input:checked + .slider {
    background-color: var(--ms-paint-statusbar-green);
    border-color: var(--ms-paint-statusbar-green);
}

input:checked + .slider:before {
    transform: translateX(11px); /* Ajuste de desplazamiento */
}

/* =============================== */
/*        BOTONES DE PRESET (Ahora en el panel derecho como un grid de iconos)     */
/* =============================== */
/* Eliminamos el estilo anterior de preset-buttons en el controls-container */
/* y creamos uno nuevo para el right-panel */

.right-panel .preset-buttons.tool-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 columnas para que encaje mejor en altura */
    gap: 3px; /* Pequeño espacio entre iconos */
    margin-top: 5px;
    padding-bottom: 8px; /* Espacio debajo de la cuadrícula */
    border-bottom: 1px solid var(--ms-paint-border-dark); /* Línea divisoria */
}

.right-panel .preset-buttons.tool-grid .preset-btn {
    width: 30px; /* Tamaño fijo pequeño */
    height: 30px;
    padding: 0; /* Eliminar padding para que el ícono sea el centro */
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.2em; /* Hacer los íconos más grandes */
    background: var(--ms-paint-bg-light);
    color: var(--ms-paint-text-primary);
    border: none;
    border-top: 1px solid var(--ms-paint-border-light);
    border-left: 1px solid var(--ms-paint-border-light);
    border-right: 1px solid var(--ms-paint-border-dark);
    border-bottom: 1px solid var(--ms-paint-border-dark);
    transition: none; /* Sin transiciones para el estilo retro */
}

.right-panel .preset-buttons.tool-grid .preset-btn i {
    display: block; /* Asegurar que el ícono se muestre correctamente */
    font-size: 1em; /* Tamaño relativo al botón */
    margin: 0; /* Sin margen extra */
}

.right-panel .preset-buttons.tool-grid .preset-btn:hover {
    background: var(--ms-paint-bg-medium);
    border-top: 1px solid var(--ms-paint-border-dark);
    border-left: 1px solid var(--ms-paint-border-dark);
    border-right: 1px solid var(--ms-paint-border-light);
    border-bottom: 1px solid var(--ms-paint-border-light);
    transform: none; /* No animar en hover */
}

/* =============================== */
/*        GIZMO 3D (Panel Derecho)   */
/* =============================== */

.gizmo-container {
    width: 100px;
    height: 100px;
    perspective: 1000px;
    margin: auto; /* Centrar en el espacio disponible */
    margin-top: 15px; /* Espacio superior */
}

.gizmo {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    animation: spin 12s linear infinite;
}

@keyframes spin {
    from {
        transform: rotateX(0deg) rotateY(0deg);
    }
    to {
        transform: rotateX(360deg) rotateY(360deg);
    }
}

.axis {
    position: absolute;
    top: 50%;
    left: 50%;
}

.axis.x {
    width: 80px;
    height: 2px;
    background: #E74C3C; /* Rojo */
    transform: translate(-50%, -50%);
}

.axis.y {
    width: 2px;
    height: 80px;
    background: #2ECC71; /* Verde */
    transform: translate(-50%, -50%);
}

.axis.z {
    width: 2px;
    height: 80px;
    background: #3498DB; /* Azul */
    transform: translate(-50%, -50%) rotateX(90deg);
}

.axis::after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    border-style: solid;
}

.axis.x::after {
    border-width: 4px 0 4px 8px;
    border-color: transparent transparent transparent #E74C3C;
    right: -8px;
    top: -3px;
}

.axis.y::after {
    border-width: 0 4px 8px 4px;
    border-color: transparent transparent #2ECC71 transparent;
    top: -8px;
    left: -3px;
}

.axis.z::after {
    border-width: 0 4px 8px 4px;
    border-color: transparent transparent #3498DB transparent;
    top: -8px;
    left: -3px;
}

.ring {
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: 2px solid;
    top: 50%;
    left: 50%;
}

.ring.x {
    border-color: #E74C3C; /* Rojo */
    transform: translate(-50%, -50%) rotateX(90deg);
}

.ring.y {
    border-color: #2ECC71; /* Verde */
    transform: translate(-50%, -50%);
}

.ring.z {
    border-color: #3498DB; /* Azul */
    transform: translate(-50%, -50%) rotateY(90deg);
}


/* =============================== */
/*        MEDIAS QUERIES (RESPONSIVE) */
/* =============================== */

@media (max-width: 968px) {
    .container {
        flex-direction: column;
        max-height: none;
        box-shadow: none;
        &::before, &::after {
            display: none; /* Ocultar barras en móvil para ahorrar espacio */
        }
    }
    /* El nuevo contenedor para los paneles se convierte en columna */
    .app-content-area {
        flex-direction: column;
    }

    .controls-container {
        flex: 1; /* Ocupa todo el ancho */
        border-right: none;
        border-bottom: 1px solid var(--ms-paint-border-shadow);
        max-height: none;
        height: auto;
        padding-bottom: 10px;
    }

    .demo-container {
        min-width: unset;
        padding: 10px 5px;
        border: none;
        border-bottom: 1px solid var(--ms-paint-border-shadow); /* Añadir borde inferior */
    }

    /* Panel derecho se ajusta al ancho completo en móvil */
    .right-panel {
        flex: 1;
        border-left: none;
        border-top: 1px solid var(--ms-paint-border-shadow); /* Borde superior en móvil */
        max-height: none;
        height: auto;
    }

    #vanish-shadow {
        font-size: 60px;
    }

    /* Ajuste de paleta de colores en móvil */
    .background-selector {
        grid-template-columns: repeat(6, 1fr); /* Más columnas en móvil si hay espacio */
        width: 100%; /* Ocupa el ancho completo */
    }
    .bg-btn {
        width: 22px; /* Ajustar tamaño de botones de color */
        height: 22px;
    }

    .ms-paint-status-bar {
        font-size: 0.65em;
        height: 20px;
        gap: 8px;
    }
}

@media (max-width: 768px) {
    body {
        padding: 2px;
    }

    fieldset {
        padding: 4px;
        margin-bottom: 6px;
    }

    legend {
        font-size: 0.75em;
        top: -6px;
        left: -4px;
        padding: 1px 3px;
    }
    legend i {
        font-size: 0.75em;
    }

    label {
        font-size: 0.7em;
    }
    label span:first-child i {
        font-size: 0.75em;
    }

    .value-display {
        font-size: 0.65em;
    }

    input[type="text"], #copy-css-button, #reset-button, .preset-btn {
        font-size: 0.75em;
        padding: 2px 5px;
    }
    #copy-css-button i, #reset-button i, .preset-btn i {
        font-size: 0.8em;
    }

    /* Los botones de preset en el panel derecho mantienen su grid de iconos */
    .right-panel .preset-buttons.tool-grid {
        grid-template-columns: repeat(4, 1fr); /* 4 columnas para iconos en tablets pequeñas */
    }
    .right-panel .preset-buttons.tool-grid .preset-btn {
        width: 28px;
        height: 28px;
    }

    #vanish-shadow {
        font-size: 45px;
    }

    .ms-paint-status-bar {
        font-size: 0.6em;
        height: 18px;
        gap: 5px;
    }
}

@media (max-width: 576px) {
    #vanish-shadow {
        font-size: 35px;
        letter-spacing: 0em;
        -webkit-text-stroke: 1px var(--dulce-outline-color);
        text-stroke: 1px var(--dulce-outline-color);
    }
    .rainbow-mode-active .char {
        -webkit-text-stroke: 1px rgba(0,0,0,0.5);
        text-stroke: 1px rgba(0,0,0,0.5);
    }

    .bg-btn {
        width: 16px; /* Aún más pequeños los botones de color */
        height: 16px;
    }
    .background-selector {
        grid-template-columns: repeat(5, 1fr); /* Menos columnas en móvil */
        padding: 0;
    }
    .right-panel .background-selector {
        grid-template-columns: repeat(4, 1fr); /* Mantener 4 columnas en el panel derecho */
    }

    .switch {
        width: 20px;
        height: 12px;
    }
    .slider:before {
        height: 8px;
        width: 8px;
        left: 2px;
        bottom: 2px;
    }
    input:checked + .slider:before {
        transform: translateX(8px);
    }

    .tooltip::after {
        padding: 2px 4px;
        font-size: 0.6em;
    }
}

/* =============================== */
/*     ANIMACIONES Y EFECTOS EXTRA   */
/* =============================== */

/* Resplandor (glow) ajustado para pixelado neón */
.glow {
    text-shadow: 0 0 3px currentColor,
                 0 0 6px currentColor,
                 0 0 9px currentColor,
                 1px 1px 0px rgba(0,0,0,0.5); /* Sombra dura de fondo */
}

/* Animación de flotación - Mantiene estilo original */
.float-animation {
    animation: float var(--animation-speed, 6s) ease-in-out infinite;
}

@keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-15px); }
    100% { transform: translateY(0px); }
}

/* Partículas de fondo - Estilo original */
.particles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
}

.particle {
    position: absolute;
    background: var(--primary); /* Usar el color primario original */
    border-radius: 50%;
    opacity: 0.3;
    animation: particle-float 20s infinite linear;
    filter: blur(2px);
}

@keyframes particle-float {
    0% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0;
        scale: 0.5;
    }
    10% {
        opacity: 0.4;
        scale: 1;
    }
    80% {
        opacity: 0.3;
        transform: translateY(-100vh) translateX(var(--particle-translate-x, 0px)) rotate(720deg);
    }
    100% {
        transform: translateY(-120vh) translateX(var(--particle-translate-x, 0px)) rotate(720deg);
        opacity: 0;
        scale: 1.5;
    }
}

/* Estilos de Tooltip - Retro */
.tooltip {
    position: relative;
    cursor: help;
}

.tooltip::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    padding: 3px 6px; /* Padding reducido */
    background: var(--ms-paint-border-shadow);
    color: var(--ms-paint-border-light);
    border-radius: 0;
    font-size: 0.7em; /* Fuente más pequeña */
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    z-index: 100;
    pointer-events: none;
}

.tooltip:hover::after {
    opacity: 1;
    visibility: visible;
}



/* Hide moveable controls in letter mode until hovered */
.letter-edit-mode .moveable-control-box {
    display: none;
}
.letter-edit-mode .char:hover + .moveable-control-box,
.letter-edit-mode .moveable-control-box:hover {
    display: block;
}
